'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var utils = require('@dynamic-labs/utils');
var decodeJwt = require('../../../shared/utils/functions/decodeJwt/decodeJwt.cjs');
var createUserProfile = require('../createUserProfile/createUserProfile.cjs');
var index = require('../storeAuthToken/index.cjs');

const updateJWTAndCreateUserProfile = (jwt) => {
    const decodedJWT = decodeJwt.decodeJwt(jwt);
    if (!jwt || !decodedJWT) {
        throw new utils.DynamicError('Invalid session');
    }
    index.storeAuthToken(jwt);
    return createUserProfile.createUserProfile(decodedJWT);
};

exports.updateJWTAndCreateUserProfile = updateJWTAndCreateUserProfile;
